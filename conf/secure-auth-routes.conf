# Secure Authentication Routes
# Add these routes to your main routes file to enable secure authentication

# Public Authentication Endpoints (no token required)
POST    /api/auth/login             controllers.SecureUsersController.login
POST    /api/auth/register          controllers.SecureUsersController.register
GET     /api/auth/username/:username/exists    controllers.SecureUsersController.usernameExists(username: String)
GET     /api/auth/email/:email/exists          controllers.SecureUsersController.emailExists(email: String)

# Protected User Endpoints (requires JWT token in Authorization header)
GET     /api/user/profile           controllers.SecureUsersController.profile
PUT     /api/user/profile           controllers.SecureUsersController.updateProfile
POST    /api/user/change-password   controllers.SecureUsersController.changePassword
POST    /api/user/logout            controllers.SecureUsersController.logout

# Admin-only Endpoints (requires JWT token + admin role)
GET     /api/admin/users            controllers.SecureUsersController.users
DELETE  /api/admin/users/:userId    controllers.SecureUsersController.deleteUser(userId: Int)

# Example of protecting existing endpoints with authentication
# Replace your existing budget routes with these protected versions:
# GET     /api/budget/:businessId/:projectId                    controllers.BudgetController.budgetBreakdownsBy(businessId: Int, projectId: Int)
# becomes:
# GET     /api/protected/budget/:businessId/:projectId          controllers.ProtectedBudgetController.budgetBreakdownsBy(businessId: Int, projectId: Int)
